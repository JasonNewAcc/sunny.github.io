<!DOCTYPE html>
<html lang="de">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Login - Holostats</title>
Â  Â  <style>
Â  Â  Â  Â  /* === Allgemeiner Seitenstil === */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  background-color: #1e1e1e;
Â  Â  Â  Â  Â  Â  color: #f0f0f0;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  /* === LOGIN FORM STYLES === */
Â  Â  Â  Â  #login-form-container {
Â  Â  Â  Â  Â  Â  background-color: #2d2d30;
Â  Â  Â  Â  Â  Â  padding: 40px;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 10px 30px rgba(0,0,0,0.7);
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 350px;
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-form-container h2 {
Â  Â  Â  Â  Â  Â  color: #4CAF50;
Â  Â  Â  Â  Â  Â  margin-top: 0;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-form-container p {
Â  Â  Â  Â  Â  Â  color: #aaa;
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-username, #login-password, #security-code { /* Security Code hinzugefÃ¼gt */
Â  Â  Â  Â  Â  Â  width: calc(100% - 30px);
Â  Â  Â  Â  Â  Â  padding: 12px 15px;
Â  Â  Â  Â  Â  Â  margin: 10px 0;
Â  Â  Â  Â  Â  Â  border: 1px solid #555;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  background-color: #3a3a3d;
Â  Â  Â  Â  Â  Â  color: #f0f0f0;
Â  Â  Â  Â  Â  Â  font-size: 1em;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }
Â  Â  Â  Â  #login-username:focus, #login-password:focus, #security-code:focus {
Â  Â  Â  Â  Â  Â  border-color: #4CAF50;
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-form-container button {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  background-color: #4CAF50;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 1.1em;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s;
Â  Â  Â  Â  }

Â  Â  Â  Â  #login-form-container button:hover {
Â  Â  Â  Â  Â  Â  background-color: #43A047;
Â  Â  Â  Â  }
Â  Â  Â  Â  #login-message {
Â  Â  Â  Â  Â  Â  color: #d9534f;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

<div id="login-form-container">
Â  Â  <h2 id="form-title">Zugriff erforderlich</h2>
Â  Â  <p id="form-message">Bitte melden Sie sich mit Benutzername und Passwort an.</p>
Â  Â Â 
Â  Â  Â  Â  <input type="text" id="login-username" placeholder="Benutzername">
Â  Â  <input type="password" id="login-password" placeholder="Passwort" onkeyup="if(event.key === 'Enter') checkLogin()">Â 
Â  Â Â 
Â  Â  Â  Â  <input type="text" id="security-code" placeholder="Security Code" style="display: none;" onkeyup="if(event.key === 'Enter') checkSecurityCode()">Â 
Â  Â Â 
Â  Â  <button id="login-button" onclick="checkLogin()">Anmelden</button>
Â  Â  <button id="verify-button" style="display: none;" onclick="checkSecurityCode()">Code prÃ¼fen</button>

Â  Â  <p id="login-message"></p>
</div>


<script>
Â  Â  // âš ï¸ WICHTIGER HINWEIS: PasswÃ¶rter sind im Klartext in accounts.json gespeichert und UNSICHER.
Â  Â Â 
Â  Â  // --- AUTHENTIFIZIERUNGSDATEN ---
Â  Â  let validAccounts = [];Â 
Â  Â  const LOGIN_KEY = 'holostats_logged_in';
Â  Â  const TARGET_PAGE = 'app.html';Â 
Â  Â  const SECURITY_CODE_KEY = 'holostats_temp_code'; // FÃ¼r die Simulation
Â  Â  let currentAttemptUser = null; // Speichert den Benutzer, der sich gerade anmeldet

Â  Â  /**
Â  Â  Â * LÃ¤dt die Zugangsdaten aus der externen accounts.json Datei.
Â  Â  Â */
Â  Â  async function loadAccounts() {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  const response = await fetch('accounts.json');Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('login-message').textContent = 'Fehler: Kontodaten konnten nicht geladen werden (accounts.json fehlt?).';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('login-message').style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const data = await response.json();
Â  Â  Â  Â  Â  Â  validAccounts = data.accounts || [];Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  document.getElementById('login-message').textContent = 'Netzwerkfehler oder Fehler beim Parsen der Kontodaten.';
Â  Â  Â  Â  Â  Â  document.getElementById('login-message').style.display = 'block';
Â  Â  Â  Â  Â  Â  console.error(error);
Â  Â  Â  Â  }
Â  Â  }

Â  Â  /**
Â  Â  Â * Generiert einen einfachen 6-stelligen Code fÃ¼r die Client-Simulation.
Â  Â  Â */
Â  Â  function generateSecurityCode() {
Â  Â  Â  Â  return Math.floor(100000 + Math.random() * 900000).toString();
Â  Â  }

Â  Â  /**
Â  Â  Â * FÃ¼hrt die Login-PrÃ¼fung (Faktor 1: Username/Passwort) durch.
Â  Â  Â */
Â  Â  function checkLogin() {
Â  Â  Â  Â  const usernameInput = document.getElementById('login-username').value;
Â  Â  Â  Â  const passwordInput = document.getElementById('login-password').value;
Â  Â  Â  Â  const loginMessage = document.getElementById('login-message');

Â  Â  Â  Â  loginMessage.style.display = 'none';

Â  Â  Â  Â  if (validAccounts.length === 0) {
Â  Â  Â  Â  Â  Â  loginMessage.textContent = 'Fehler: Kontodaten wurden noch nicht geladen. Bitte warten oder Seite neu laden.';
Â  Â  Â  Â  Â  Â  loginMessage.style.display = 'block';
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  const accountFound = validAccounts.find(account =>Â 
Â  Â  Â  Â  Â  Â  account.username === usernameInput && account.password === passwordInput
Â  Â  Â  Â  );

Â  Â  Â  Â  if (accountFound) {
Â  Â  Â  Â  Â  Â  currentAttemptUser = accountFound;

Â  Â  Â  Â  Â  Â  if (accountFound.discordId) {
Â  Â  Â  Â  Â  Â  Â  Â  // Benutzer hat 2FA (Discord ID)
Â  Â  Â  Â  Â  Â  Â  Â  switchToSecurityCodeStep(usernameInput);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  // Benutzer hat kein 2FA - Direkter Login
Â  Â  Â  Â  Â  Â  Â  Â  handleSuccessfulLogin();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  loginMessage.textContent = 'Fehler: UngÃ¼ltiger Benutzername oder Passwort.';
Â  Â  Â  Â  Â  Â  loginMessage.style.display = 'block';
Â  Â  Â  Â  }
Â  Â  }
Â  Â  Â  Â 
Â  Â  /**
Â  Â  Â * Wechselt die Formularansicht zum Eingabeschritt des Security Codes.
Â  Â  Â * @param {string} username - Der Benutzername fÃ¼r die Konsolenausgabe.
Â  Â  Â */
Â  Â  function switchToSecurityCodeStep(username) {
Â  Â  Â  Â  // Verstecke die Anmeldefelder
Â  Â  Â  Â  document.getElementById('login-username').style.display = 'none';
Â  Â  Â  Â  document.getElementById('login-password').style.display = 'none';
Â  Â  Â  Â  document.getElementById('login-button').style.display = 'none';

Â  Â  Â  Â  // Zeige das Code-Feld und den Code-Button
Â  Â  Â  Â  document.getElementById('security-code').value = ''; 
Â  Â  Â  Â  document.getElementById('security-code').style.display = 'block';
Â  Â  Â  Â  document.getElementById('verify-button').style.display = 'block';
Â  Â  Â  Â  document.getElementById('security-code').focus();

Â  Â  Â  Â  document.getElementById('form-title').textContent = 'Security Code erforderlich';
Â  Â  Â  Â  document.getElementById('form-message').textContent = 'Wir haben einen Code an Ihren Discord gesendet. Bitte geben Sie ihn ein.';
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ðŸ”¥ WICHTIGE SIMULATION: Code generieren und speichern
Â  Â  Â  Â  const generatedCode = generateSecurityCode();
Â  Â  Â  Â  sessionStorage.setItem(SECURITY_CODE_KEY, generatedCode); 
Â  Â  Â  Â  console.log(`[SICHERHEITSWARNUNG: SIMULATION] Der zu verwendende Code fÃ¼r ${username} ist: ${generatedCode}`);
Â  Â  Â  Â  console.log(`Im Produktionsbetrieb MUSS dieser Code vom Server per Discord gesendet werden!`);

Â  Â  }
Â  Â  Â  Â 
Â  Â  /**
Â  Â  Â * FÃ¼hrt die PrÃ¼fung des Security Codes (Faktor 2) durch.
Â  Â  Â */
Â  Â  function checkSecurityCode() {
Â  Â  Â  Â  const codeInput = document.getElementById('security-code').value;
Â  Â  Â  Â  const loginMessage = document.getElementById('login-message');
Â  Â  Â  Â  loginMessage.style.display = 'none';

Â  Â  Â  Â  // Holt den simulierten Code (der eigentlich vom Server kommen mÃ¼sste)
Â  Â  Â  Â  const expectedCode = sessionStorage.getItem(SECURITY_CODE_KEY);

Â  Â  Â  Â  if (codeInput === expectedCode) {
Â  Â  Â  Â  Â  Â  // Erfolg: 2FA war erfolgreich
Â  Â  Â  Â  Â  Â  sessionStorage.removeItem(SECURITY_CODE_KEY); // Code lÃ¶schen
Â  Â  Â  Â  Â  Â  handleSuccessfulLogin();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  loginMessage.textContent = 'Fehler: UngÃ¼ltiger Security Code.';
Â  Â  Â  Â  Â  Â  loginMessage.style.display = 'block';
Â  Â  Â  Â  }
Â  Â  }

Â  Â  /**
Â  Â  Â * Behandelt den erfolgreichen Abschluss des Logins.
Â  Â  Â */
Â  Â  function handleSuccessfulLogin() {
Â  Â  Â  Â  sessionStorage.setItem(LOGIN_KEY, 'true');
Â  Â  Â  Â  window.location.href = TARGET_PAGE;
Â  Â  }

Â  Â  // Beim Laden zuerst die Konten laden und dann auf den Login-Status prÃ¼fen
Â  Â  document.addEventListener('DOMContentLoaded', async () => {
Â  Â  Â  Â  document.getElementById('login-message').textContent = 'Lade Kontodaten...';
Â  Â  Â  Â  document.getElementById('login-message').style.display = 'block';
Â  Â  Â  Â Â 
Â  Â  Â  Â  await loadAccounts(); 

Â  Â  Â  Â  // Wenn Konten erfolgreich geladen wurden, Nachricht verstecken
Â  Â  Â  Â  if (validAccounts.length > 0) {
Â  Â  Â  Â  Â  Â  document.getElementById('login-message').style.display = 'none';Â 
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  const isLoggedIn = sessionStorage.getItem(LOGIN_KEY) === 'true';
Â  Â  Â  Â  if (isLoggedIn) {
Â  Â  Â  Â  Â  Â  Â window.location.href = TARGET_PAGE;
Â  Â  Â  Â  }
Â  Â  Â  Â  document.getElementById('login-username').focus();
Â  Â  });
</script>
</body>
</html>
