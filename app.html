<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Holostats Spielerstatistik-Suche</title>
    <style>
        /* === Allgemeiner Stil und Dunkles Thema === */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1e1e1e; /* Dunkler Hintergrund */
            color: #f0f0f0; /* Helle Textfarbe */
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 50px;
        }
        .container {
            display: none; /* Standardmäßig versteckt, wird nach Login über JS sichtbar */
            width: 90%;
            max-width: 700px;
            background: #2d2d30; /* Dunkle Container-Fläche */
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        h1 {
            color: #4CAF50; /* Akzentfarbe Grün */
            text-align: center;
            margin-bottom: 5px;
            font-size: 2em;
        }
        
        /* === LOGOUT BUTTON STYLE === */
        #logout-button {
            float: right; /* Nach rechts verschieben */
            padding: 8px 15px;
            margin-top: -50px; /* Hoch zur Überschrift schieben */
            background-color: #d9534f; /* Rote Akzentfarbe */
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.2s;
        }
        #logout-button:hover {
            background-color: #c9302c;
        }

        #current-date {
            text-align: right;
            font-size: 0.8em;
            color: #aaa;
            margin-bottom: 25px;
            border-bottom: 1px solid #3a3a3d;
            padding-bottom: 10px;
            clear: both; /* Stellt sicher, dass es unter dem Button beginnt */
        }
        
        /* === Suchfeld-Design (Suchfenster) === */
        #search-container {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            position: relative;
        }
        #search-input {
            padding: 12px 15px;
            font-size: 1.1em;
            border: 2px solid #555;
            border-radius: 8px;
            flex-grow: 1;
            background-color: #3a3a3d;
            color: #f0f0f0;
            transition: border-color 0.3s;
        }
        #search-input:focus {
            border-color: #4CAF50; /* Akzentfarbe bei Fokus */
            outline: none;
        }
        #search-button {
            padding: 12px 20px;
            font-size: 1.1em;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #search-button:hover {
            background-color: #43A047;
        }
        
        /* === Vorschlags-Container (Top 5 & Dynamisch) === */
        #suggestions-container, #dynamic-suggestions-container {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 8px;
            background-color: #3a3a3d;
            border-left: 5px solid #4CAF50; /* Grüner Akzent */
        }
        #suggestions-container h4, #dynamic-suggestions-container h4 {
            margin-top: 0;
            color: #4CAF50; 
            margin-bottom: 10px;
            font-size: 1em;
        }
        .suggestion-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .suggestion-player {
            background-color: #555;
            color: #fff;
            padding: 7px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            font-weight: bold;
        }
        .suggestion-player:hover {
            background-color: #4CAF50;
            transform: translateY(-2px);
        }

        /* === Ergebnis-Karten === */
        #results-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }
        .player-card {
            border: 1px solid #444;
            padding: 15px;
            border-radius: 8px;
            width: 160px;
            text-align: center;
            background: #3a3a3d;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer; 
        }
        .player-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.5), 0 0 10px #4CAF50;
        }
        .player-card img {
            width: 64px;
            height: 64px;
            border-radius: 50%; /* Rundes Profilbild */
            border: 3px solid #4CAF50;
            margin-bottom: 10px;
            image-rendering: pixelated;
        }
        .player-card h3 {
            margin: 0 0 8px 0;
            font-size: 1.2em;
            color: #e0e0e0;
            word-break: break-all;
        }
        .player-card p {
            margin: 0;
            font-size: 0.95em;
            color: #bbb;
        }
        .divider {
            margin: 10px 0;
            border-top: 1px solid #444;
        }
        
        /* === Meldungen und Fehler === */
        #error-message {
            text-align: center;
            margin-top: 20px;
            padding: 10px;
            border-radius: 6px;
            font-weight: bold;
            display: none; /* Initial versteckt */
        }
        /* Erfolgsmeldung */
        #error-message[style*="background-color: #d4edda"] { 
            background-color: #384239 !important;
            border: 1px solid #4CAF50;
            color: #4CAF50 !important;
        }
        /* Fehlermeldung */
        #error-message[style*="background-color: #f2dede"] { 
            background-color: #5d3f42 !important;
            border: 1px solid #d9534f;
            color: #d9534f !important;
        }

        /* === DETAIL MODAL STYLES === */
        .modal {
            display: none; 
            position: fixed;
            z-index: 100; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.8); 
        }
        .modal-content {
            background-color: #3a3a3d;
            margin: 10% auto;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 450px;
            position: relative;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.7);
        }
        .close-button {
            color: #aaa;
            float: right;
            font-size: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
        }
        .close-button:hover,
        .close-button:focus {
            color: #fff;
        }
        #detail-content img {
            width: 128px; 
            height: auto;
            image-rendering: pixelated;
            margin: 15px auto 25px auto;
            border: 4px solid #4CAF50;
            border-radius: 50%;
        }
        #detail-content h2 {
            color: #4CAF50;
            margin-top: 0;
            border-bottom: 1px solid #444;
            padding-bottom: 15px;
            font-size: 1.8em;
        }
        #detail-content p {
            margin: 12px 0;
            text-align: left;
            padding: 5px 10px;
            font-size: 1.05em;
            background-color: #2d2d30;
            border-radius: 4px;
        }
        #detail-content b {
            color: #fff;
        }
        #detail-content a {
            display: block;
            margin-top: 25px;
            padding: 12px;
            background-color: #007bff; /* Sekundäre Akzentfarbe Blau */
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            transition: background-color 0.2s;
        }
        #detail-content a:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

<div class="container">
    <h1><span style="color: white;">Sunny_Casino</span> - Umsatz Suchen</h1>
    
    <button id="logout-button" onclick="logout()">Abmelden</button>
    <p id="current-date">Daten-Stand: 07.12.2025</p>

    <div id="search-container">
        <input type="text" id="search-input" placeholder="Spielernamen eingeben..." onkeyup="handleSearchInput(event)">
        <button id="search-button" onclick="searchPlayers(true)">Suchen</button>
    </div>
    
    <div id="dynamic-suggestions-container" style="display: none;">
        </div>

    <div id="suggestions-container">
        </div>

    <p id="error-message"></p>
    
    <div id="results-container">
        </div>
</div>

<div id="player-detail-modal" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closePlayerDetails()">&times;</span>
        <div id="detail-content">
            </div>
    </div>
</div>
<script>
    // ** START DER NEUESTEN SPIELERDATEN **
    let playerStats = [
    {
      "uuid": "2143da9f-503b-4e4a-835a-d1d7f37a0af1",
      "playername": "JasonNewAcc",
      "wager": 4904301
    },
    {
      "uuid": "3afc41d9-6ac7-41d1-b7c2-8286ce21765d",
      "playername": "xNotNamex",
      "wager": 7864090
    },
    {
      "uuid": "895d190d-77d7-4c85-b79b-bcd6768011ca",
      "playername": "Lilly_197",
      "wager": 3022045
    },
    {
      "uuid": "1038f0a9-4431-490a-b07c-c3b5222b259c",
      "playername": "3infach_Craz7",
      "wager": 9644035
    },
    {
      "uuid": "2e809eab-3e83-4632-9743-d061c119b59f",
      "playername": "Yxlukas",
      "wager": 13346075
    },
    {
      "uuid": "467e9ab0-b048-4307-b5fd-1ea110f45817",
      "playername": "lblenni",
      "wager": 256010
    },
    {
      "uuid": "a490eea8-725d-4140-9ac7-68bd751229de",
      "playername": "1real_nox",
      "wager": 1244210
    },
    {
      "uuid": "9c1e2e4e-650b-4018-a22d-6197eca0a49f",
      "playername": "1Verfehlter",
      "wager": 1596185
    },
    {
      "uuid": "9d593273-a33d-40de-9e66-78ff12991e7e",
      "playername": "ces_cot",
      "wager": 65
    },
    {
      "uuid": "9bda69ad-3ebe-42e2-a48f-96fa6f3a4351",
      "playername": "KenRyugujiYT",
      "wager": 5
    },
    {
      "uuid": "42b0dfc2-40d9-44d3-8678-5091f15afde7",
      "playername": "BiBo_Th3_Ripp3r",
      "wager": 1660235
    },
    {
      "uuid": "f2ed72bb-31ef-42c3-8456-372c85aa739b",
      "playername": "Orb_Store",
      "wager": 5
    },
    {
      "uuid": "52ffcd1b-7cb4-48e7-82de-03a41afa061d",
      "playername": "pusplocke",
      "wager": 1962145
    },
    {
      "uuid": "77706451-4eaa-4061-9e03-169e27cee023",
      "playername": "Oxication_HD",
      "wager": 2432015
    },
    {
      "uuid": "fe10c7c9-83f4-4603-a423-d5cdcd1f2def",
      "playername": "RiryC001",
      "wager": 5
    },
    {
      "uuid": "068ff8c2-9918-411d-9593-d2b7e2fd371d",
      "playername": "Jere0258",
      "wager": 20010
    },
    {
      "uuid": "0e7c2bab-cf1b-4d3c-954f-e2a11cd0b582",
      "playername": "zNight649",
      "wager": 83098080
    },
    {
      "uuid": "cab5bcd2-7b88-4a1d-94ba-dbaffc1a56f2",
      "playername": "xAlserak",
      "wager": 15128155
    },
    {
      "uuid": "a39d4373-60ad-4e18-852b-e0796dedef62",
      "playername": "Premium_man_",
      "wager": 5248075
    },
    {
      "uuid": "7e9774da-dd78-3fde-bbbb-61b84a5c979d",
      "playername": "!RobLoxxGhosT",
      "wager": 2352020
    },
    {
      "uuid": "3a5309af-6510-4445-916a-660aaeb0e76e",
      "playername": "Lattenrost1234",
      "wager": 12608075
    },
    {
      "uuid": "27c8b333-4954-32d7-a27c-12e4c61b58da",
      "playername": "!Russivan639",
      "wager": 920015
    },
    {
      "uuid": "d2362403-231e-4d2e-b26c-0ad7a8a24b80",
      "playername": "FriksGames",
      "wager": 17848320
    },
    {
      "uuid": "8dca34b2-9500-4d01-a510-a53037f20579",
      "playername": "Oxiiiii_42",
      "wager": 10
    },
    {
      "uuid": "21b987f7-2e45-4417-823c-2a9922635047",
      "playername": "1Kxksen",
      "wager": 2005
    },
    {
      "uuid": "75f31271-ea69-4ad4-b275-884dedb6d357",
      "playername": "salina3534",
      "wager": 9514055
    },
    {
      "uuid": "a380117b-7213-44b8-bb8d-1e0d3071aa19",
      "playername": "ItzZ_PauleXx",
      "wager": 104035
    },
    {
      "uuid": "440e3388-4cc4-4d7f-b5cd-048a5e9b8eea",
      "playername": "versabberter",
      "wager": 3426060
    },
    {
      "uuid": "79852977-c186-4c74-ba6a-186cec4c953a",
      "playername": "CryzZ11",
      "wager": 2246040
    },
    {
      "uuid": "7854f1fd-3050-41c7-99f4-60ad0d6eec25",
      "playername": "ItzZ_Popeye",
      "wager": 17858235
    },
    {
      "uuid": "5c2a3eee-ab92-4ff8-b71f-416c995ba97c",
      "playername": "zdobeq",
      "wager": 832170
    },
    {
      "uuid": "d0560923-c832-4c51-8053-d4869aef69ca",
      "playername": "RealShiva",
      "wager": 512005
    },
    {
      "uuid": "62a7ebe6-c142-42e7-b639-dc0d58236a2e",
      "playername": "Teufelswesen",
      "wager": 384000
    },
    {
      "uuid": "51597d23-214a-47a0-9fe6-2427e013efb8",
      "playername": "Trogoso",
      "wager": 8146085
    },
    {
      "uuid": "67da9ce1-b83d-49ae-9df6-146d26212f22",
      "playername": "Silberjason",
      "wager": 136040
    },
    {
      "uuid": "4a8fcd88-c3e0-4bc8-8e76-7cb825095c83",
      "playername": "meerkatinthehat",
      "wager": 20
    },
    {
      "uuid": "966f6fef-a5ce-3486-aa85-3e43f265336b",
      "playername": "!uzzi193159",
      "wager": 155
    },
    {
      "uuid": "e278048c-993f-4dda-adce-d29e93887aaa",
      "playername": "Null_FPS",
      "wager": 256015
    },
    {
      "uuid": "05a43700-011f-4ea5-b3b6-e7d189758271",
      "playername": "4real2k",
      "wager": 1664010
    },
    {
      "uuid": "6ec4de13-0deb-4b08-b0d1-1f27dbb9fff4",
      "playername": "Rxffel",
      "wager": 6025
    },
    {
      "uuid": "d774b1f9-5078-439a-a267-17d6a5b02f5d",
      "playername": "Telephos85",
      "wager": 3492015
    },
    {
      "uuid": "98bd03cf-ac4c-4bcc-82a4-19e74c7d7ea2",
      "playername": "Nectaner",
      "wager": 16010
    },
    {
      "uuid": "c1565fda-3110-4549-904b-8cd07d7a464a",
      "playername": "Agent007_",
      "wager": 38270
    },
    {
      "uuid": "7b097e9c-6269-4f4e-8cad-910bfa64a675",
      "playername": "DrInk3653",
      "wager": 3584005
    },
    {
      "uuid": "b1eeae81-97cc-4798-a908-9848cf35953d",
      "playername": "XZSupaA_Gecko",
      "wager": 5
    },
    {
      "uuid": "f460c89e-c955-456c-8d3a-fecae5fd6d88",
      "playername": "1Lxca",
      "wager": 130005
    },
    {
      "uuid": "bce9a4da-6993-4066-b4ac-51ea75b24092",
      "playername": "BoBderBaumester",
      "wager": 384005
    },
    {
      "uuid": "4be759a2-a416-4e35-b1d8-7b61deb6ccb1",
      "playername": "JustHackl",
      "wager": 5
    },
    {
      "uuid": "61a62498-35a3-4437-9746-7ce258e77464",
      "playername": "Lumania2020",
      "wager": 768000
    },
    {
      "uuid": "63a2f0d3-70a5-4c4f-a609-ada33451c8d6",
      "playername": "zFlevo",
      "wager": 4000
    },
    {
      "uuid": "f04cc68f-cf1d-45d5-bf9c-0f2f1410d5da",
      "playername": "mayumyi",
      "wager": 256000
    },
    {
      "uuid": "02b57fac-b8be-4693-90ca-50be497b7945",
      "playername": "9Sleepyy",
      "wager": 11278170
    },
    {
      "uuid": "8dc50d76-b7cc-406e-8ecf-01bbfb45f4e1",
      "playername": "LytnoGG",
      "wager": 192060
    },
    {
      "uuid": "1478210a-6b94-4486-bb9b-bfc8c1a786db",
      "playername": "Crazylaser46",
      "wager": 490090
    },
    {
      "uuid": "33510a1b-0aff-4cd5-8f8a-62dfdce109c7",
      "playername": "Stepmarvin_",
      "wager": 1542010
    },
    {
      "uuid": "b85224c9-60bb-4d5b-8623-a778176c6b59",
      "playername": "KurzVorGucci",
      "wager": 128005
    },
    {
      "uuid": "4da4007c-d36e-4e51-85e3-b9032fc3a158",
      "playername": "Alterschwede45",
      "wager": 640255
    },
    {
      "uuid": "b0d05b0a-1433-4f09-82ae-45e7a95d2a16",
      "playername": "ReLaXeD_YT",
      "wager": 1024000
    },
    {
      "uuid": "9ce71af3-f8be-4d98-a1ee-84f2e969729e",
      "playername": "Farfuss293",
      "wager": 9350115
    },
    {
      "uuid": "9a630acf-e2a8-4851-b427-35830297878e",
      "playername": "OkBinStili",
      "wager": 876035
    },
    {
      "uuid": "e0233016-36a8-40ad-a9d4-9b3c9acc47b4",
      "playername": "xJazeek",
      "wager": 16135
    },
    {
      "uuid": "f06b9822-5c24-4a0b-8a57-4dcd5640e256",
      "playername": "UndeadDuck",
      "wager": 128000
    },
    {
      "uuid": "983b1a4a-9f5d-4e76-8fb3-ee3459066851",
      "playername": "Em1n3e7",
      "wager": 64005
    },
    {
      "uuid": "0b12bb65-2f18-408a-a004-87e756bdb83e",
      "playername": "Verhunted",
      "wager": 130005
    },
    {
      "uuid": "b4e86782-c1b5-4fbe-8e37-24410ddb49d2",
      "playername": "Luksch007x",
      "wager": 11008000
    },
    {
      "uuid": "15fef32b-8f3b-457d-a005-adb89baa490c",
      "playername": "IchGehOOC",
      "wager": 512055
    },
    {
      "uuid": "1eabc4cd-f6de-4038-b67b-9b0aa0840247",
      "playername": "mcpack22",
      "wager": 5
    },
    {
      "uuid": "b05acf76-7fc9-43d2-a16b-12e78a4d4bd1",
      "playername": "Gaming__Buddy",
      "wager": 15
    },
    {
      "uuid": "687102df-08c8-47fe-8771-1bb03ebfdb8e",
      "playername": "Amelie1up",
      "wager": 128090
    },
    {
      "uuid": "10dd715e-c489-400d-8024-5f5440840685",
      "playername": "Marcel1UP",
      "wager": 384120
    },
    {
      "uuid": "56ed648d-9fa2-4027-93e4-32c6e87c1967",
      "playername": "NiemandKilltMich",
      "wager": 18602010
    },
    {
      "uuid": "0869cafa-4ceb-47ac-93ac-20993c9a02c9",
      "playername": "BerndDasBrot2",
      "wager": 1512030
    },
    {
      "uuid": "0b94f4e3-2f1a-45ad-9ea1-d2b83e881783",
      "playername": "yasin112",
      "wager": 2005
    },
    {
      "uuid": "affd6ad8-58c3-4e93-be9f-d4ba32fdebfa",
      "playername": "NightWolfLG",
      "wager": 256005
    },
    {
      "uuid": "19c19880-6b67-49bc-b691-c24c6c3ab97f",
      "playername": "DerTechnoGod",
      "wager": 64040
    },
    {
      "uuid": "fd9ba1a8-5bc1-47b2-871c-974c105f31db",
      "playername": "ItsEmily17",
      "wager": 10
    },
    {
      "uuid": "c1cc9cbc-5458-43f3-87a0-b9c3c369e931",
      "playername": "Emilian141",
      "wager": 1370225
    },
    {
      "uuid": "9e65449f-1036-4c0d-8c55-82bef3bc70f7",
      "playername": "AceStarling9506",
      "wager": 25
    },
    {
      "uuid": "2821a07e-6619-4938-b108-4d1300b9c497",
      "playername": "dcue",
      "wager": 3072010
    },
    {
      "uuid": "be35c47b-7970-49a3-8a97-f29016238e64",
      "playername": "Schlagzeugnis",
      "wager": 1792005
    },
    {
      "uuid": "1fccf772-0ffe-4de5-bae9-e002177f1a47",
      "playername": "nxmooo",
      "wager": 1088000
    },
    {
      "uuid": "8e6380e9-a597-4c51-8e5e-b5825c0330b9",
      "playername": "Monster1239344",
      "wager": 132155
    },
    {
      "uuid": "36b8a9a9-41ce-49dc-b22f-d724b0595ca7",
      "playername": "ItsZynex",
      "wager": 13760140
    },
    {
      "uuid": "3a907163-f7b1-4ab3-9703-746d4097ff32",
      "playername": "Eifnurgym1161",
      "wager": 9856010
    },
    {
      "uuid": "977f8273-1a86-4410-8790-186ee09c74f7",
      "playername": "Bannfee",
      "wager": 4000015
    },
    {
      "uuid": "19b7c223-a2e7-451f-b269-d089f956c79e",
      "playername": "Der_Jodocy",
      "wager": 2196090
    },
    {
      "uuid": "838d974a-22b0-43b6-85b8-266bf413caa8",
      "playername": "Illegal_Baum",
      "wager": 2070010
    },
    {
      "uuid": "d173deb5-49f4-3294-b22b-021fa33f0661",
      "playername": "!Bauer+Jason1539",
      "wager": 552025
    },
    {
      "uuid": "3721798b-3d6d-4916-9b57-d2e82f7636e0",
      "playername": "WlzoX_",
      "wager": 5
    },
    {
      "uuid": "0cad4823-76ed-4ebd-9879-663cf95984a0",
      "playername": "Unverpackt",
      "wager": 66005
    },
    {
      "uuid": "f4cd0046-d100-4091-b0d5-879239fd2583",
      "playername": "Minikuchen__",
      "wager": 512005
    },
    {
      "uuid": "04d99b96-41f2-4120-a41d-fa48c4ec6eca",
      "playername": "ewasahbe1310",
      "wager": 512000
    },
    {
      "uuid": "4baeb542-47b2-4dbc-838f-b3dd6b721064",
      "playername": "abdu_y_",
      "wager": 5
    },
    {
      "uuid": "28d18a8d-3096-4e7c-a295-19fce61d8bbd",
      "playername": "ManLionsCity",
      "wager": 5
    } ]; // ** ENDE DER NEUESTEN SPIELERDATEN **
    
    
    // --- AUTHENTIFIZIERUNGSEINSTELLUNGEN ---
    const LOGIN_KEY = 'holostats_logged_in';
    const LOGIN_PAGE = 'index.html'; // Weiterleitung bei fehlendem Login
    
    // --- ENDE AUTHENTIFIZIERUNGSEINSTELLUNGEN ---

    
    // --- SOUND-FUNKTIONEN ---
    // Definiert den Pfad zu Ihrer lokalen MP3-Datei
    const CLICK_SOUND_URL = './buttonclick.mp3';
    
    // Audio-Objekt nur für den Klick-Sound
    const clickAudio = new Audio(CLICK_SOUND_URL);
    
    /**
     * Spielt den Klick-Sound ab (nur für Spieler-Elemente).
     */
    function playClickSound() {
        clickAudio.currentTime = 0;
        clickAudio.volume = 0.7; 
        clickAudio.play().catch(e => console.warn("Click-Sound konnte nicht abgespielt werden:", e));
    }
    
    // --- ENDE SOUND-FUNKTIONEN ---
    
    
    // --- HILFSFUNKTIONEN ---
    
    /**
     * Bereinigt den Spielernamen für die Mineskin-API.
     */
    function cleanPlayerNameForSkin(playerName) {
        return playerName.startsWith('!') ? playerName.substring(1) : playerName;
    }

    /**
     * Formatiert eine Zahl mit Tausender-Trennzeichen (deutsch).
     */
    function formatNumber(num) {
        return (typeof num === 'number' && !isNaN(num)) ? num.toLocaleString('de-DE') : 'N/A';
    }
    
    /**
     * Schließt das Detail-Modal.
     */
    function closePlayerDetails() {
        const modal = document.getElementById('player-detail-modal');
        modal.style.display = 'none';
    }
    
    /**
     * Zeigt eine Erfolgs- oder Fehlermeldung an.
     */
    function displayMessage(message, type = 'success') {
        const errorMessage = document.getElementById('error-message');
        errorMessage.textContent = message;
        errorMessage.style.display = 'block';
        if (type === 'success') {
            errorMessage.style.backgroundColor = '#d4edda';
            errorMessage.style.color = '#155724';
        } else {
            errorMessage.style.backgroundColor = '#f2dede';
            errorMessage.style.color = '#a94442';
        }
    }

    /**
     * Erstellt und zeigt eine Spielerkarte an.
     */
    function createPlayerCard(player, resultsContainer) {
        const card = document.createElement('div');
        card.className = 'player-card';
        card.onclick = () => {
            showPlayerDetails(player.playername); 
            playClickSound();
        };
        
        const cleanName = cleanPlayerNameForSkin(player.playername);
        const skinUrl = `https://mineskin.eu/head/${cleanName}/64`;
        
        const img = document.createElement('img');
        img.src = skinUrl;
        img.alt = `Skin-Kopf von ${player.playername}`;
    
        const nameHeading = document.createElement('h3');
        nameHeading.textContent = player.playername;
        
        const divider = document.createElement('div');
        divider.className = 'divider';
        
        const wagerText = document.createElement('p');
        wagerText.innerHTML = `<b>Umsatz:</b> <br>${formatNumber(player.wager)}`;
        
        card.appendChild(img);
        card.appendChild(nameHeading);
        card.appendChild(divider);
        card.appendChild(wagerText);
        resultsContainer.appendChild(card);
    }

    // --- VORSCHLAGS-LOGIK ---

    /**
     * Sortiert Spieler nach Wager absteigend und gibt die Top N zurück.
     */
    function getTopPlayers(count) {
        return [...playerStats]
            .sort((a, b) => b.wager - a.wager)
            .slice(0, count);
    }

    /**
     * Zeigt die Top 5 Spieler als anklickbare Vorschläge an.
     */
    function displayTopSuggestions() {
        const topPlayers = getTopPlayers(5);
        const container = document.getElementById('suggestions-container');
        container.style.display = 'block';
        container.innerHTML = '<h4>⭐ Top 5 Spieler (Nach Umsatz)</h4><div class="suggestion-list"></div>';
        const list = container.querySelector('.suggestion-list');

        topPlayers.forEach(player => {
            const span = document.createElement('span');
            span.className = 'suggestion-player';
            span.textContent = player.playername;
            span.onclick = () => setInputAndSearch(player.playername);
            list.appendChild(span);
        });
    }

    /**
     * Zeigt dynamische Vorschläge basierend auf der Sucheingabe.
     */
    function displayDynamicSuggestions(searchTerm) {
        const dynamicContainer = document.getElementById('dynamic-suggestions-container');
        dynamicContainer.innerHTML = ''; 

        if (searchTerm.length < 2) {
            dynamicContainer.style.display = 'none';
            displayTopSuggestions();
            return;
        }

        const exactMatch = playerStats.find(p => p.playername.toLowerCase() === searchTerm);
        
        const similarPlayers = playerStats.filter(p => 
            p.playername.toLowerCase().includes(searchTerm) && p.playername.toLowerCase() !== searchTerm
        ).slice(0, 8); 

        if (exactMatch || similarPlayers.length > 0) {
            dynamicContainer.style.display = 'block';
            dynamicContainer.innerHTML = '<h4>Ähnliche Spielernamen (Klicken zum Suchen)</h4><div class="suggestion-list"></div>';
            const list = dynamicContainer.querySelector('.suggestion-list');

            if (exactMatch) {
                const span = document.createElement('span');
                span.className = 'suggestion-player';
                span.textContent = exactMatch.playername + " (Exakt)";
                span.style.backgroundColor = '#4CAF50';
                span.onclick = () => setInputAndSearch(exactMatch.playername);
                list.appendChild(span);
            }

            similarPlayers.forEach(player => {
                const span = document.createElement('span');
                span.className = 'suggestion-player';
                span.textContent = player.playername;
                span.onclick = () => setInputAndSearch(player.playername);
                list.appendChild(span);
            });
            document.getElementById('suggestions-container').style.display = 'none';
        } else {
            dynamicContainer.style.display = 'none';
            displayTopSuggestions();
        }
    }


    // --- SUCHE UND DETAILS ---

    /**
     * Setzt den Suchwert und startet die Suche.
     */
    function setInputAndSearch(playerName) {
        document.getElementById('search-input').value = playerName;
        searchPlayers(true);
        playClickSound()
    }
    
    /**
     * Behandelt Tastatureingaben im Suchfeld.
     */
    function handleSearchInput(event) {
        const input = document.getElementById('search-input');
        const searchTerm = input.value.toLowerCase().trim();

        if (event && event.type === 'keyup') {
            if (event.key === 'Enter') {
                searchPlayers(true);
            } else {
                document.getElementById('results-container').innerHTML = '';
                document.getElementById('error-message').style.display = 'none';
                displayDynamicSuggestions(searchTerm);
            }
        }
    }

    /**
     * Sucht nach Spielern.
     */
    function searchPlayers(isFullSearch = false) {
        const input = document.getElementById('search-input');
        const searchTerm = input.value.toLowerCase().trim();
        const resultsContainer = document.getElementById('results-container');
        const errorMessage = document.getElementById('error-message');
        const dynamicContainer = document.getElementById('dynamic-suggestions-container');
        const topContainer = document.getElementById('suggestions-container');
        
        resultsContainer.innerHTML = '';
        errorMessage.style.display = 'none';
        dynamicContainer.style.display = 'none';
        topContainer.style.display = 'none';

        if (searchTerm.length === 0) {
            displayMessage('Bitte einen Spielernamen eingeben.', 'error');
            displayTopSuggestions();
            return;
        }

        let foundPlayers = playerStats.filter(p => p.playername.toLowerCase() === searchTerm);
        
        if (foundPlayers.length === 0 && isFullSearch) {
            foundPlayers = playerStats.filter(p => p.playername.toLowerCase().includes(searchTerm));
        }
        
        if (foundPlayers.length > 0) {
            foundPlayers
                .sort((a, b) => b.wager - a.wager)
                .forEach(player => createPlayerCard(player, resultsContainer));
            displayMessage(`${foundPlayers.length} Spieler für "${input.value}" gefunden.`, 'success');
        } else {
            displayMessage(`Kein Spieler mit dem Namen "${input.value}" gefunden.`, 'error');
            displayTopSuggestions();
        }
    }

    /**
     * Sucht den Spieler und öffnet das Detail-Modal.
     */
    function showPlayerDetails(playerName) {
        const player = playerStats.find(p => p.playername === playerName);
        const detailContent = document.getElementById('detail-content');
        const modal = document.getElementById('player-detail-modal');

        if (!player) {
            displayMessage(`Fehler: Spieler '${playerName}' wurde nicht in den Daten gefunden.`, 'error');
            return;
        }
        
        const cleanName = cleanPlayerNameForSkin(player.playername);
        const nameMcUrl = `https://de.namemc.com/profile/${player.uuid}`;
        const detailSkinUrl = `https://mineskin.eu/skin/${cleanName}/128`;
        
        detailContent.innerHTML = `
            <h2>${player.playername}</h2>
            <img src="${detailSkinUrl}" alt="Voller Skin von ${player.playername}">
            <p><b>UUID:</b> ${player.uuid}</p>
            <p><b>Gesamtwager:</b> ${formatNumber(player.wager)}</p>
            
            <a href="${nameMcUrl}" target="_blank">Profil auf NameMC ansehen</a>
        `;

        modal.style.display = 'block';
    }


    /**
     * Meldet den Benutzer ab und leitet zur Login-Seite um.
     */
    function logout() {
        // Löscht den gespeicherten Login-Schlüssel
        sessionStorage.removeItem(LOGIN_KEY);
        // Leitet zur Login-Seite um
        window.location.href = LOGIN_PAGE;
    }


    // --- INITIALISIERUNG ---
    
    /**
     * Initialisiert die Hauptanwendung, nachdem der Login erfolgreich war.
     */
    function initializeApp() {
        // Entfernt Hover-Sounds (falls zuvor hinzugefügt)
        const searchInput = document.getElementById('search-input');
        if (searchInput.onmouseenter) searchInput.onmouseenter = null;
        
        const searchButton = document.getElementById('search-button');
        if (searchButton.onmouseenter) searchButton.onmouseenter = null;

        if (playerStats.length > 0) {
             displayMessage(`Daten von ${playerStats.length} Spielern geladen. Sie können nun suchen oder einen vorgeschlagenen Spieler wählen.`, 'success');
             displayTopSuggestions();
        } else {
             displayMessage('⚠️ Wichtig: Es wurden keine Spielerdaten gefunden. Bitte die Daten prüfen.', 'error');
        }
    }


    // Schließt das Detail-Modal, wenn außerhalb des Inhalts geklickt wird
    window.onclick = function(event) {
        const detailModal = document.getElementById('player-detail-modal');
        if (event.target === detailModal) {
            closePlayerDetails();
        }
    }
    
    // Haupt-DOMContentLoaded-Handler zur Authentifizierung
    document.addEventListener('DOMContentLoaded', () => { 
        const isLoggedIn = sessionStorage.getItem(LOGIN_KEY) === 'true';
        const container = document.querySelector('.container');

        if (isLoggedIn) {
            // 1. Wenn eingeloggt, zeige Container und initialisiere App
            container.style.display = 'block'; 
            initializeApp();
        } else {
            // 2. Wenn NICHT eingeloggt, leite zur Login-Seite um
            window.location.href = LOGIN_PAGE;
        }
    });

</script>
</body>
</html>

